import pandas as pd


class CreateQuarterPanelData:

    def __init__(self, start_date, end_date, n_obs_each_quarter):
        self.start_date = start_date
        self.end_date = end_date
        self.n_obs_each_quarter = n_obs_each_quarter
        # self.n_obs = n_obs
        # self.n_splits = n_splits
        self.df = self._create()

    def _create(self):
        r = (pd.date_range(pd.to_datetime(self.start_date),
                           pd.to_datetime(self.end_date) + pd.offsets.QuarterBegin(1), freq='Q').strftime(
            '%Y-%m-%d').tolist())
        print('Quarters List: ', r)

        l = []
        for i in r:
            temp_l = [i] * self.n_obs_each_quarter
            l.extend(temp_l)
        # print(l)
        length_of_l = len(l)
        # print(length_of_l)

        self.df = pd.DataFrame({'date': l, 'a': range(length_of_l), 'b': range(length_of_l)})

        return self.df


if __name__ == "__main__":

    df = CreateQuarterPanelData(start_date = '2017-12-31', end_date = '2019-12-31', n_obs_each_quarter=10).df
    print(df.head())
    print(df.tail())