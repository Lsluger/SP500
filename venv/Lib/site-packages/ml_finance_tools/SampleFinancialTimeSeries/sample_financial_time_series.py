from pandas_datareader.data import DataReader
import numpy as np

class SampleFinancialTimeSeries:
    """Pulls sample equity time series using ticker name and date range"""

    def __init__(self, ticker, start_date, end_date, log_prices=False, data_source='yahoo'):
        self.ticker = ticker
        self.start_date = start_date
        self.end_date = end_date
        self.data_source = data_source
        self.log_prices = log_prices

        self.sample_data = self._get_data()

    def _get_data(self):
        dataframe = DataReader(name=self.ticker, data_source=self.data_source, start=self.start_date, end=self.end_date)
        if self.log_prices:
            dataframe = np.log(dataframe)
        return dataframe

if __name__ == "__main__":
    df0 = SampleFinancialTimeSeries('AAPL',
                                   start_date='2018-01-01',
                                   end_date='2019-01-01',
                                   log_prices=False).sample_data
    print(df0.head())

    df1 = DataReader('AAPL', start='2018-01-01', end='2019-01-01', data_source='yahoo')
    print(df1.head())

    assert df0.equals(df1), 'Dataframes are not identical'
